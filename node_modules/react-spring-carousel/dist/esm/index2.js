import{jsx as e}from"react/jsx-runtime";import{createContext as t,useRef as r,useContext as n}from"react";import{config as i,useSpring as c,animated as o}from"react-spring";import{useDrag as u}from"@use-gesture/react";import{u as s,a as l,b as a,c as f,d}from"./useThumbsModule-0944decf.js";import"rxjs";import"screenfull";const h=t(void 0),g=Object.assign(Object.assign({},i.default),{mass:1,velocity:0});function m({items:t,withLoop:n=!1,draggingSlideTreshold:m,springConfig:v=i.default,shouldResizeOnWindowResize:p=!0,withThumbs:y=!1,enableThumbsWrapperScroll:b=!0,slideWhenThresholdIsReached:x=!0,carouselSlideAxis:w="x",thumbsSlideAxis:T="x",prepareThumbsData:O,initialActiveItem:j=0,initialStartingPosition:I,disableGestures:S=!1,gutter:E=0,startEndGutter:A=0,touchAction:C,slideAmount:R,freeScroll:$=!1,enableFreeScrollDrag:W,itemsPerSlide:L=1,slideType:M="fixed"}){const F=r(!0),N=r("initial"),P=n?t.length===L?[...t,...t,...t,...t,...t]:[...t,...t,...t]:t,z=r(j),D=r(null),B=r(null),k=r(!1),q=r(!1),G=r(!1),V=r(0),Y=r(!1),H=r(0),X=r(0),J=r(0),K=r(t),Q=r(null!=m?m:0),U=r(L),Z=r(E),_=r(A),ee=r(j),te=r(I),re=r(w);U.current=L,Z.current=E,_.current=A,ee.current=j,te.current=I,re.current=w;const[ne,ie]=c((()=>({y:0,x:0,onChange:({value:e})=>{D.current&&$&&(D.current["x"===re.current?"scrollLeft":"scrollTop"]=Math.abs(e[re.current]))}})));function ce(){const e=null===(t=B.current)||void 0===t?void 0:t.querySelector(".use-spring-carousel-item");var t;if(!e)throw Error("No carousel items available!");return e.getBoundingClientRect()["x"===re.current?"width":"height"]+Z.current}function oe(){return ne[re.current].get()}function ue(){return ce()*t.length<function(){if(!D.current)throw new Error("mainCarouselWrapperRef is not available");return D.current.getBoundingClientRect()["x"===re.current?"width":"height"]}()}function se(){var e;return Math.round(Number(null===(e=B.current)||void 0===e?void 0:e["x"===re.current?"scrollWidth":"scrollHeight"])-B.current.getBoundingClientRect()["x"===re.current?"width":"height"])}function le(){return 0===Ee()}function ae(){if(!B.current)return 0;const e=ce();if("fluid"===M&&"number"==typeof R){if(R<e)throw new Error("slideAmount must be greater than the width of a single item.");return R}return e}function fe(e,r){const i="x"===re.current?"left":"top";function c(){return ce()*t.length}function o(t){n?(e.style.top="0px",e.style[i]=`-${t-_.current}px`):(e.style.left="0px",e.style.top="0px",r&&F.current&&(e.style[i]=`calc(-${r} * 100%)`))}function u(){o(c())}if("fixed"===M){if(U.current>1)switch(te.current){default:case"start":u();break;case"center":s=U.current,o(c()-ae()*Math.round((s-1)/2));break;case"end":!function(e){o(c()-ae()*Math.round(e-1))}(U.current)}else u()}else u();var s}function de(){if(H.current=window.innerWidth,"fluid"===M){if(ue())return void ie.start({immediate:!0,[re.current]:0});if(V.current=se(),Y.current){const e=-V.current;ie.start({immediate:!0,[re.current]:e})}X.current=window.innerWidth}else ie.start({immediate:!0,[re.current]:-ae()*Ee()});V.current=se(),fe(B.current)}function he(){window.innerWidth===H.current||$||de()}s((()=>{Q.current=m||Math.floor(ae()/2/2),de()}),[m,L,E,A,j,I,w,T]);const{useListenToCustomEvent:ge,emitObservable:me}=l(),{enterFullscreen:ve,exitFullscreen:pe,getIsFullscreen:ye}=a({mainCarouselWrapperRef:D,emitObservable:me,handleResize:he}),{thumbsFragment:be,handleThumbsScroll:xe}=f({withThumbs:y,items:t,thumbsSlideAxis:T,springConfig:v,prepareThumbsData:O,slideType:M,getFluidWrapperScrollValue:se,getSlideValue:ae});function we(){if(!D.current)throw new Error("Missing mainCarouselWrapperRef.current");return D.current["x"===re.current?"scrollLeft":"scrollTop"]}function Te(){return"boolean"==typeof W?W:"function"==typeof W&&W()}const Oe=u((e=>{const t=e.dragging,r=e.offset["x"===re.current?0:1],i=e.movement["x"===re.current?0:1],c=i>Q.current,o=i<-Q.current,u=e.direction["x"===re.current?0:1];function s(){e.cancel()}function l(){je(u>0?"prev":"next")}function a(){me(Object.assign({eventName:"onDrag",slideActionType:Ie()},e))}function f(){"fluid"===M?ue()||le()&&"prev"===Ie()?ie.start({[re.current]:0,config:Object.assign({velocity:e.velocity},v)}):Y.current&&"next"===Ie()?ie.start({[re.current]:-V.current,config:Object.assign({velocity:e.velocity},v)}):ie.start({[re.current]:J.current,config:Object.assign({velocity:e.velocity},v)}):ie.start({[re.current]:-Ee()*ae(),config:Object.assign({velocity:e.velocity},v)})}function d(){Math.abs(oe())+100>=V.current&&"next"===Ie()&&(Y.current=!0),"prev"===Ie()&&(Y.current=!1)}if($&&Te())return t&&(Re()||Ce(!0),l(),a(),d()),ie.start({from:{[re.current]:we()},to:{[re.current]:-r},config:{velocity:e.velocity,friction:50,tension:1400}}),0===we()&&"prev"===Ie()?void s():void(e.last&&("prev"===Ie()?Pe(e.velocity):ze(e.velocity),Ce(!1)));if(t){if(Re()||Ce(!0),a(),l(),d(),$){if(Te()){if(0===we()&&"prev"===Ie())return void s();ie.start({config:{velocity:e.velocity,friction:50,tension:1400},from:{[re.current]:we()},to:{[re.current]:-r}})}return}if(ie.start({[re.current]:r,config:{velocity:e.velocity,friction:50,tension:1e3}}),(c||o)&&ue()&&"fluid"===M)s(),f();else if(Y.current&&"next"===Ie()&&o)Y.current=!1,s(),ie.start({[re.current]:-V.current});else if(x){if(o)return s(),void(!n&&Ne()?f():ze(e.velocity));if(c)return s(),void(!n&&le()?f():Pe(e.velocity))}}if(e.last&&!x&&(o||c)&&!$)return Ce(!1),void(o?!n&&Ne()?f():ze(e.velocity):c&&(!n&&le()?f():Pe(e.velocity)));!e.last||o||c||$||(f(),me(Object.assign({eventName:"onDrag",slideActionType:Ie()},e)))}),{enabled:!S,axis:re.current,from:()=>$?"x"===re.current?[-we(),0]:[0,-we()]:[ne.x.get(),ne.y.get()]});function je(e){N.current=e}function Ie(){return N.current}function Se(e){z.current=e}function Ee(){return z.current}function Ae(e){q.current=e}function Ce(e){k.current=e}function Re(){return k.current}function $e(){const e=Ee();return 0===e?t.length-1:e-1}function We(){const e=Ee();return e===t.length-1?0:e+1}function Le(e){return t.findIndex((t=>t.id===e))}function Me(e,t){if("number"==typeof e)return{[re.current]:e};if("number"!=typeof t)throw new Error("to values is not a number!");return{[re.current]:-ae()*t}}function Fe({from:e,to:r=-1,customTo:n,immediate:i=!1,onRest:c=(()=>{}),velocity:o}){i||(Se(r),Ae(!0),me({eventName:"onSlideStartChange",slideActionType:Ie(),nextItem:{index:"fluid"===M?-1:r,id:"fluid"===M?"":t[r].id}})),J.current=Me(n,r)[w],ie.start(Object.assign(Object.assign(Object.assign(Object.assign({},function(e){return"number"==typeof e?{from:{[re.current]:e}}:{}}(e)),{to:Me(n,r)}),o?{config:Object.assign(Object.assign({},g),{velocity:o,friction:void 0,tension:void 0})}:{config:Object.assign({velocity:0},v)}),{immediate:i,onRest:e=>{e.finished&&(Ce(!1),Ae(!1),c(),i||me({eventName:"onSlideChange",slideActionType:Ie(),currentItem:{index:"fluid"===M?-1:Ee(),id:"fluid"===M?"":t[Ee()].id}}))}})),b&&y&&!i&&xe(r,Ie())}function Ne(){return Ee()===t.length-1}function Pe(e){if(je("prev"),Y.current=!1,"fluid"===M){if(Y.current=!1,ue())return;const r=oe()+ae()+200;if($){const t=D.current.scrollLeft-ae();Fe({customTo:t<0?0:t,from:D.current.scrollLeft,velocity:e})}else Fe(r>=0?n?{from:oe()-ce()*t.length,velocity:e,customTo:oe()-ce()*t.length+ae()}:{customTo:0,velocity:e}:{customTo:oe()+ae(),velocity:e})}else{if(!n&&0===Ee()||G.current)return;le()?Fe({from:oe()-ae()*t.length,to:t.length-1,velocity:e}):Fe({to:$e(),velocity:e})}}function ze(e){if(je("next"),"fluid"===M){if(ue())return;const r=Math.abs(oe()-ae())+100>=V.current;if($){const t=D.current.scrollLeft+ae()>V.current,r=D.current.scrollLeft+ae();Fe({velocity:e,customTo:t?V.current:r,from:D.current.scrollLeft})}else if(n&&Math.abs(oe()-ae())>=t.length*ce()){const r=ce()*t.length;Fe({from:oe()+r,customTo:oe()+r-ae(),velocity:e})}else{if(Y.current)return;r?(Y.current=!0,Fe({customTo:-V.current,velocity:e})):Fe({customTo:oe()-ae(),velocity:e})}}else{if(!n&&Ee()===P.length-1||G.current)return;Math.abs(oe()-ae()+25)>V.current&&!Re()?Y.current=!0:Y.current?Fe({to:t.length-U.current,velocity:e}):Ne()?Fe({from:oe()+ae()*t.length,to:0,velocity:e}):Fe({to:We(),velocity:e})}}function De(e){let r=0;if(r="string"==typeof e?t.findIndex((t=>t.id===e)):e,r>=t.length)throw Error("The item you want to slide to doesn't exist. This could be due to the fact that \n        you provide a wrong id or a higher numeric index.");if(r===Ee()||t.length!==K.current.length&&Ee()<t.length)return;const n=Le(K.current[Ee()].id);je(Le(t[r].id)>n?"next":"prev"),Fe({to:r})}d((()=>{if(L%2==0&&te.current)throw new Error("initialStartingPosition can be only used if itemsPerSlide is an even value.");if(Q.current<0)throw new Error("draggingSlideTreshold must be greater than 0");if(Q.current>ae()/2)throw new Error(`draggingSlideTreshold must be equal or less than the half of the width of an item, which is ${Math.floor(ae()/2)}`);if(U.current<1)throw new Error("The itemsPerSlide prop can't be less than 1.");if(U.current>t.length)throw new Error("The itemsPerSlide prop can't be greater than the total length of the items you provide.");if(ee.current<0)throw new Error("The initialActiveItem cannot be less than 0.");if(ee.current>t.length)throw new Error("The initialActiveItem cannot be greater than the total length of the items you provide.");p||console.warn("You set shouldResizeOnWindowResize={false}; be aware that the carousel could behave in a strange way if you also use the fullscreen functionality or if you change the mobile orientation.")})),d((()=>{function e(){document.hidden?G.current=!0:G.current=!1}return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}})),d((()=>{F.current=!1,V.current=se(),X.current=window.innerWidth,H.current=window.innerWidth,j>0&&(Fe({to:j,immediate:!0}),Se(j),!n&&B.current&&(B.current.style.top="0px",B.current.style.left="0px"))})),s((()=>{j<t.length&&j!==z.current&&(Fe({to:j,immediate:!0}),Se(j))}),[j]),s((()=>{if(p)return window.addEventListener("resize",he),()=>{window.removeEventListener("resize",he)}}),[p]),s((()=>{B.current&&("x"===re.current&&(B.current.style.top="0px"),"y"===re.current&&(B.current.style.left="0px"))}),[w]),s((()=>{V.current=se();!(t.length===K.current.length)&&t.length<K.current.length&&De(t.length-1),K.current=t}),[se,t]);const Be=Object.assign({useListenToCustomEvent:ge,getIsFullscreen:ye,enterFullscreen:ve,exitFullscreen:pe,getIsAnimating:function(){return q.current},getIsDragging:Re,getIsNextItem:function(e){const r=Le(e),i=Ee();return n&&i===t.length-1?0===r:r===i+1},getIsPrevItem:function(e){const r=Le(e),i=Ee();return n&&0===i?r===t.length-1:r===i-1},slideToPrevItem(){Pe()},slideToNextItem(){ze()}},"fixed"===M?{slideToItem:De,getIsActiveItem:e=>Le(e)===Ee(),getCurrentActiveItem:()=>({id:t[Ee()].id,index:Ee()})}:{});const ke=e(h.Provider,Object.assign({value:Be},{children:e("div",Object.assign({ref:D,className:"use-spring-carousel-main-wrapper","data-testid":"use-spring-carousel-wrapper"},$?{onWheel(){ne[re.current].stop()}}:{},{style:Object.assign({display:"flex",position:"relative",width:"100%",height:"100%"},$?"x"===re.current?{overflowX:"auto"}:{overflowY:"auto"}:{})},{children:e(o.div,Object.assign({},Oe(),{className:"use-spring-carousel-track-wrapper","data-testid":"use-spring-carousel-animated-wrapper",ref:e=>{e&&(B.current=e,fe(e,ee.current))},style:Object.assign(Object.assign(Object.assign({display:"flex",position:"relative",touchAction:S?"unset":C||("x"===re.current?"pan-y":"pan-x"),flexDirection:"x"===re.current?"row":"column"},function(){const e=`calc(100% - ${2*_.current}px)`;return{width:"x"===re.current?e:"100%",height:"y"===re.current?e:"100%"}}()),function(){const e=t.length/L*100,r=100/L,n="x"===re.current?"left":"y",i=Math.floor(50/r);if("fixed"===M){if("center"===te.current)return{[n]:`calc(-${e}% + ${r*i}%)`};if("end"===te.current)return{[n]:`calc(-${e}% + ${r*(2*i)}%)`}}return{[n]:"0px"}}()),$?{}:ne)},{children:P.map((({id:t,renderItem:r},n)=>{return e("div",Object.assign({className:"use-spring-carousel-item","data-testid":"use-spring-carousel-item-wrapper",style:Object.assign({display:"flex",position:"relative"},(i=U.current,"fixed"===M?Object.assign(Object.assign({},"x"===re.current?{marginRight:`${Z.current}px`}:{marginBottom:`${Z.current}px`}),{flex:`1 0 calc(100% / ${i} - ${Z.current*(i-1)/i}px)`}):Object.assign({},"x"===re.current?{marginRight:`${Z.current}px`}:{marginBottom:`${Z.current}px`})))},{children:r}),`${t}-${n}`);var i}))}))}))})),qe=e(h.Provider,Object.assign({value:Be},{children:be}));return Object.assign(Object.assign({},Be),{carouselFragment:ke,thumbsFragment:qe})}function v(){const e=n(h);if(!e)throw new Error("useSpringCarouselContext must be used only inside a component that is rendered inside the Carousel.");return e}export{m as useSpringCarousel,v as useSpringCarouselContext};
//# sourceMappingURL=index2.js.map
